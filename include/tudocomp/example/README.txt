See the Tutorial for an in-depth explanation about the code here.
